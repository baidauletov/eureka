{"version":3,"sources":["webpack://ideal-succotash/./src/components/range-picker/index.js","webpack://ideal-succotash/./src/components/sortable-table/index.js","webpack://ideal-succotash/./src/components/column-chart/index.js","webpack://ideal-succotash/./src/pages/dashboard/bestsellers-header.js","webpack://ideal-succotash/./src/pages/dashboard/index.js","webpack://ideal-succotash/./src/utils/fetch-json.js"],"names":["RangePicker","date","toLocaleString","dateStyle","constructor","from","Date","to","event","isOpen","this","element","classList","contains","isRangePicker","target","close","showDateFrom","selected","render","formatDate","document","createElement","innerHTML","template","firstElementChild","subElements","getSubElements","initEventListeners","Promise","resolve","subElement","querySelectorAll","dataset","elem","input","selector","addEventListener","onDocumentClick","toggle","onSelectorClick","renderDateRangePicker","onRangePickerCellClick","remove","showDate1","showDate2","setMonth","getMonth","renderCalendar","controlLeft","querySelector","controlRight","prev","next","renderHighlight","cell","value","cellDate","toISOString","add","selectedFromElem","closest","selectedToElem","showDate","setDate","monthStr","month","table","dayIndex","getDay","getDate","dateValue","selectingFrom","dispatchEvent","CustomEvent","bubbles","detail","removeEventListener","destroy","SortableTable","headersConfig","url","sorted","id","find","item","sortable","order","isSortLocally","step","start","end","async","bottom","getBoundingClientRect","documentElement","clientHeight","loading","data","loadData","update","column","newOrder","asc","desc","toggleOrder","append","arrow","sortLocally","sortOnServer","URL","wrapper","getTable","renderRows","searchParams","set","fetchJson","addRows","body","getTableRows","rows","childNodes","getTableHeader","map","getHeaderRow","join","title","getHeaderSortingArrow","getTableBody","getTableRow","header","onSortClick","onWindowScroll","sortedData","sortData","length","arr","sortType","customSorting","direction","sort","a","b","localeCompare","reduce","accum","ColumnChart","label","link","getColumnBody","maxValue","Math","max","scale","chartHeight","percent","toFixed","floor","getLink","headerData","bodyData","textContent","Page","ORDERS","SALES","CUSTOMERS","encodeURIComponent","ordersData","salesData","customersData","all","Object","values","components","sortableTable","getDataForColumnCharts","ordersDataTotal","salesDataTotal","customersDataTotal","ordersChart","salesChart","customersChart","getTime","rangePicker","initComponents","renderComponents","keys","forEach","component","root","$element","updateChartsComponents","updateTableComponent","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","window","reason","alert"],"mappings":"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","file":"dashboard-index-js-748.js","sourcesContent":["export default class RangePicker {\r\n  element = null;\r\n  subElements = {};\r\n  selectingFrom = true;\r\n  selected = {\r\n    from: new Date(),\r\n    to: new Date()\r\n  };\r\n\r\n  static formatDate (date) {\r\n    return date.toLocaleString('ru', {dateStyle: 'short'})\r\n  }\r\n\r\n  onDocumentClick = event => {\r\n    const isOpen = this.element.classList.contains('rangepicker_open');\r\n    const isRangePicker = this.element.contains(event.target);\r\n\r\n    if (isOpen && !isRangePicker) {\r\n      this.close();\r\n    }\r\n  };\r\n\r\n  constructor({from = new Date(), to = new Date()} = {}) {\r\n    this.showDateFrom = new Date(from);\r\n    this.selected = {from, to};\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template () {\r\n    const from = RangePicker.formatDate(this.selected.from);\r\n    const to = RangePicker.formatDate(this.selected.to);\r\n\r\n    return `<div class=\"rangepicker\">\r\n      <div class=\"rangepicker__input\" data-elem=\"input\">\r\n        <span data-elem=\"from\">${from}</span> -\r\n        <span data-elem=\"to\">${to}</span>\r\n      </div>\r\n      <div class=\"rangepicker__selector\" data-elem=\"selector\"></div>\r\n    </div>`;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    this.initEventListeners();\r\n\r\n    return Promise.resolve(this.element);\r\n  }\r\n\r\n  getSubElements (element) {\r\n    const subElements = {};\r\n\r\n    for (const subElement of element.querySelectorAll('[data-elem]')) {\r\n      subElements[subElement.dataset.elem] = subElement;\r\n    }\r\n\r\n    return subElements;\r\n  }\r\n\r\n  initEventListeners () {\r\n    const {input, selector} = this.subElements;\r\n\r\n    document.addEventListener('click', this.onDocumentClick, true);\r\n    input.addEventListener('click', () => this.toggle());\r\n    selector.addEventListener('click', event => this.onSelectorClick(event));\r\n  }\r\n\r\n  toggle() {\r\n    this.element.classList.toggle('rangepicker_open');\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  onSelectorClick({target}) {\r\n    if (target.classList.contains('rangepicker__cell')) {\r\n      this.onRangePickerCellClick(target);\r\n    }\r\n  }\r\n\r\n  close() {\r\n    this.element.classList.remove('rangepicker_open');\r\n  }\r\n\r\n  renderDateRangePicker() {\r\n    const showDate1 = new Date(this.showDateFrom);\r\n    const showDate2 = new Date(this.showDateFrom);\r\n    const { selector } = this.subElements;\r\n\r\n    showDate2.setMonth(showDate2.getMonth() + 1);\r\n\r\n    selector.innerHTML = `\r\n      <div class=\"rangepicker__selector-arrow\"></div>\r\n      <div class=\"rangepicker__selector-control-left\"></div>\r\n      <div class=\"rangepicker__selector-control-right\"></div>\r\n      ${this.renderCalendar(showDate1)}\r\n      ${this.renderCalendar(showDate2)}\r\n    `;\r\n\r\n    const controlLeft = selector.querySelector('.rangepicker__selector-control-left');\r\n    const controlRight = selector.querySelector('.rangepicker__selector-control-right');\r\n\r\n    controlLeft.addEventListener('click', () => this.prev());\r\n    controlRight.addEventListener('click', () => this.next());\r\n\r\n    this.renderHighlight();\r\n  }\r\n\r\n  prev () {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() - 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  next () {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() + 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  renderHighlight() {\r\n    const { from, to } = this.selected;\r\n\r\n    for (const cell of this.element.querySelectorAll('.rangepicker__cell')) {\r\n      const { value } = cell.dataset;\r\n      const cellDate = new Date(value);\r\n\r\n      cell.classList.remove('rangepicker__selected-from');\r\n      cell.classList.remove('rangepicker__selected-between');\r\n      cell.classList.remove('rangepicker__selected-to');\r\n\r\n      if (from && value === from.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-from');\r\n      } else if (to && value === to.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-to');\r\n      } else if (from && to && cellDate >= from && cellDate <= to) {\r\n        cell.classList.add('rangepicker__selected-between');\r\n      }\r\n    }\r\n\r\n    if (from) {\r\n      const selectedFromElem = this.element.querySelector(`[data-value=\"${from.toISOString()}\"]`);\r\n      if (selectedFromElem) {\r\n        selectedFromElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-from');\r\n      }\r\n    }\r\n\r\n    if (to) {\r\n      const selectedToElem = this.element.querySelector(`[data-value=\"${to.toISOString()}\"]`);\r\n      if (selectedToElem) {\r\n        selectedToElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-to');\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCalendar(showDate) {\r\n    const date = new Date(showDate);\r\n    const getGridStartIndex = dayIndex => {\r\n      const index = dayIndex === 0 ? 6 : (dayIndex - 1); // make Sunday (0) the last day\r\n      return index + 1;\r\n    };\r\n\r\n    date.setDate(1);\r\n\r\n    // text-transform: capitalize\r\n    const monthStr = date.toLocaleString('ru', {month: 'long'});\r\n\r\n    let table = `<div class=\"rangepicker__calendar\">\r\n      <div class=\"rangepicker__month-indicator\">\r\n        <time datetime=${monthStr}>${monthStr}</time>\r\n      </div>\r\n      <div class=\"rangepicker__day-of-week\">\r\n        <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\r\n      </div>\r\n      <div class=\"rangepicker__date-grid\">\r\n    `;\r\n\r\n    // first day of month starts after a space\r\n    // * * * 1 2 3 4\r\n    table += `\r\n      <button type=\"button\"\r\n        class=\"rangepicker__cell\"\r\n        data-value=\"${date.toISOString()}\"\r\n        style=\"--start-from: ${getGridStartIndex(date.getDay())}\">\r\n          ${date.getDate()}\r\n      </button>`;\r\n\r\n    date.setDate(2);\r\n\r\n    while (date.getMonth() === showDate.getMonth()) {\r\n      table += `\r\n        <button type=\"button\"\r\n          class=\"rangepicker__cell\"\r\n          data-value=\"${date.toISOString()}\">\r\n            ${date.getDate()}\r\n        </button>`;\r\n\r\n      date.setDate(date.getDate() + 1);\r\n    }\r\n\r\n    // close the table\r\n    table += '</div></div>';\r\n\r\n    return table;\r\n  }\r\n\r\n  onRangePickerCellClick(target) {\r\n    const { value } = target.dataset;\r\n\r\n    if (value) {\r\n      const dateValue = new Date(value);\r\n\r\n      if (this.selectingFrom) {\r\n        this.selected = {\r\n          from: dateValue,\r\n          to:   null\r\n        };\r\n        this.selectingFrom = false;\r\n        this.renderHighlight();\r\n      } else {\r\n        if (dateValue > this.selected.from) {\r\n          this.selected.to = dateValue;\r\n        } else {\r\n          this.selected.to = this.selected.from;\r\n          this.selected.from = dateValue;\r\n        }\r\n\r\n        this.selectingFrom = true;\r\n        this.renderHighlight();\r\n      }\r\n\r\n      if (this.selected.from && this.selected.to) {\r\n        this.dispatchEvent();\r\n        this.close();\r\n        this.subElements.from.innerHTML = RangePicker.formatDate(this.selected.from);\r\n        this.subElements.to.innerHTML = RangePicker.formatDate(this.selected.to)\r\n      }\r\n    }\r\n  }\r\n\r\n  dispatchEvent () {\r\n    this.element.dispatchEvent(new CustomEvent('date-select', {\r\n      bubbles: true,\r\n      detail:  this.selected\r\n    }));\r\n  }\r\n\r\n  remove () {\r\n    this.element.remove();\r\n    // TODO: Warning! To remove listener  MUST be passes the same event phase\r\n    document.removeEventListener('click', this.onDocumentClick, true);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n    this.selectingFrom = true;\r\n    this.selected = {\r\n      from: new Date(),\r\n      to: new Date()\r\n    };\r\n\r\n    return this;\r\n  }\r\n}\r\n","import fetchJson from \"../../utils/fetch-json.js\";\r\n\r\nconst BACKEND_URL = 'https://course-js.javascript.ru';\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n  step = 20;\r\n  start = 1;\r\n  end = this.start + this.step;\r\n\r\n  onWindowScroll = async() => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n    const { id, order } = this.sorted;\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading && !this.isSortLocally) {\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n\r\n      this.loading = true;\r\n\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n      this.update(data);\r\n\r\n      this.loading = false;\r\n    }\r\n  };\r\n\r\n  onSortClick = event => {\r\n    const column = event.target.closest('[data-sortable=\"true\"]');\r\n    const toggleOrder = order => {\r\n      const orders = {\r\n        asc: 'desc',\r\n        desc: 'asc'\r\n      };\r\n\r\n      return orders[order];\r\n    };\r\n\r\n    if (column) {\r\n      const { id, order } = column.dataset;\r\n      const newOrder = toggleOrder(order);\r\n\r\n      this.sorted = {\r\n        id,\r\n        order: newOrder\r\n      };\r\n\r\n      column.dataset.order = newOrder;\r\n      column.append(this.subElements.arrow);\r\n\r\n      if (this.isSortLocally) {\r\n        this.sortLocally(id, newOrder);\r\n      } else {\r\n        this.sortOnServer(id, newOrder);\r\n      }\r\n    }\r\n  };\r\n\r\n  constructor(headersConfig = [], {\r\n    url = '',\r\n    sorted = {\r\n      id: headersConfig.find(item => item.sortable).id,\r\n      order: 'asc'\r\n    },\r\n    isSortLocally = false,\r\n    step = 20,\r\n    start = 1,\r\n    end = start + step\r\n  } = {}) {\r\n\r\n    this.headersConfig = headersConfig;\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async render() {\r\n    const {id, order} = this.sorted;\r\n    const wrapper = document.createElement('div');\r\n\r\n    wrapper.innerHTML = this.getTable();\r\n\r\n    const element = wrapper.firstElementChild;\r\n\r\n    this.element = element;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n    this.initEventListeners();\r\n  }\r\n\r\n  async loadData(id, order, start = this.start, end = this.end) {\r\n    this.url.searchParams.set('_sort', id);\r\n    this.url.searchParams.set('_order', order);\r\n    this.url.searchParams.set('_start', start);\r\n    this.url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  addRows(data) {\r\n    this.data = data;\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(data);\r\n  }\r\n\r\n  update(data) {\r\n    const rows = document.createElement('div');\r\n\r\n    this.data = [...this.data, ...data];\r\n    rows.innerHTML = this.getTableRows(data);\r\n\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  getTableHeader() {\r\n    return `<div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n      ${this.headersConfig.map(item => this.getHeaderRow(item)).join('')}\r\n    </div>`;\r\n  }\r\n\r\n  getHeaderRow({id, title, sortable}) {\r\n    const order = this.sorted.id === id ? this.sorted.order : 'asc';\r\n\r\n    return `\r\n      <div class=\"sortable-table__cell\" data-id=\"${id}\" data-sortable=\"${sortable}\" data-order=\"${order}\">\r\n        <span>${title}</span>\r\n        ${this.getHeaderSortingArrow(id)}\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeaderSortingArrow(id) {\r\n    const isOrderExist = this.sorted.id === id ? this.sorted.order : '';\r\n\r\n    return isOrderExist\r\n      ? `<span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>`\r\n      : '';\r\n  }\r\n\r\n  getTableBody(data) {\r\n    return `\r\n      <div data-element=\"body\" class=\"sortable-table__body\">\r\n        ${this.getTableRows(data)}\r\n      </div>`;\r\n  }\r\n\r\n  getTableRows(data) {\r\n    return data.map(item => `\r\n      <div class=\"sortable-table__row\">\r\n        ${this.getTableRow(item, data)}\r\n      </div>`\r\n    ).join('');\r\n  }\r\n\r\n  getTableRow(item) {\r\n    const cells = this.headersConfig.map(({id, template}) => {\r\n      return {\r\n        id,\r\n        template\r\n      };\r\n    });\r\n\r\n    return cells.map(({id, template}) => {\r\n      return template\r\n        ? template(item[id])\r\n        : `<div class=\"sortable-table__cell\">${item[id]}</div>`;\r\n    }).join('');\r\n  }\r\n\r\n  getTable() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        ${this.getTableHeader()}\r\n        ${this.getTableBody(this.data)}\r\n\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\r\n          No products\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onSortClick);\r\n    document.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  sortLocally(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order) {\r\n    const start = 1;\r\n    const end = start + this.step;\r\n    const data = await this.loadData(id, order, start, end);\r\n\r\n    this.renderRows(data);\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.addRows(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  sortData(id, order) {\r\n    const arr = [...this.data];\r\n    const column = this.headersConfig.find(item => item.id === id);\r\n    const {sortType, customSorting} = column;\r\n    const direction = order === 'asc' ? 1 : -1;\r\n\r\n    return arr.sort((a, b) => {\r\n      switch (sortType) {\r\n        case 'number':\r\n          return direction * (a[id] - b[id]);\r\n        case 'string':\r\n          return direction * a[id].localeCompare(b[id], 'ru');\r\n        case 'custom':\r\n          return direction * customSorting(a, b);\r\n        default:\r\n          return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n    document.removeEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.subElements = {};\r\n  }\r\n}\r\n","export default class ColumnChart {\r\n  element;\r\n  subElements = {};\r\n  chartHeight = 50;\r\n\r\n  constructor({\r\n    data = [],\r\n    label = '',\r\n    link = '',\r\n    value = 0\r\n  } = {}) {\r\n    this.data = data;\r\n    this.label = label;\r\n    this.link = link;\r\n    this.value = value;\r\n\r\n    this.render();\r\n  }\r\n\r\n  getColumnBody(data) {\r\n    const maxValue = Math.max(...data);\r\n\r\n    return data\r\n    .map(item => {\r\n      const scale = this.chartHeight / maxValue;\r\n      const percent = (item / maxValue * 100).toFixed(0);\r\n\r\n      return `<div style=\"--value: ${Math.floor(item * scale)}\" data-tooltip=\"${percent}%\"></div>`;\r\n    })\r\n    .join('');\r\n  }\r\n\r\n  getLink() {\r\n    return this.link ? `<a class=\"column-chart__link\" href=\"${this.link}\">View all</a>` : '';\r\n  }\r\n\r\n  get template () {\r\n    return `\r\n      <div class=\"column-chart column-chart_loading\" style=\"--chart-height: ${this.chartHeight}\">\r\n        <div class=\"column-chart__title\">\r\n          Total ${this.label}\r\n          ${this.getLink()}\r\n        </div>\r\n        <div class=\"column-chart__container\">\r\n          <div data-element=\"header\" class=\"column-chart__header\">\r\n            ${this.value}\r\n          </div>\r\n          <div data-element=\"body\" class=\"column-chart__chart\">\r\n            ${this.getColumnBody(this.data)}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  async render() {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n    this.element = element.firstElementChild;\r\n\r\n    if (this.data.length) {\r\n      this.element.classList.remove(`column-chart_loading`);\r\n    }\r\n\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    return this.element;\r\n  }\r\n\r\n  getSubElements (element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  update ({headerData, bodyData}) {\r\n    this.subElements.header.textContent = headerData;\r\n    this.subElements.body.innerHTML = this.getColumnBody(bodyData);\r\n  }\r\n\r\n  destroy() {\r\n    this.element.remove();\r\n  }\r\n}\r\n","const header = [\r\n  {\r\n    id: 'images',\r\n    title: 'Image',\r\n    sortable: false,\r\n    template: data => {\r\n      return `\r\n          <div class=\"sortable-table__cell\">\r\n            <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\r\n          </div>\r\n        `;\r\n    }\r\n  },\r\n  {\r\n    id: 'title',\r\n    title: 'Name',\r\n    sortable: true,\r\n    sortType: 'string'\r\n  },\r\n  {\r\n    id: 'quantity',\r\n    title: 'Quantity',\r\n    sortable: true,\r\n    sortType: 'number'\r\n  },\r\n  {\r\n    id: 'price',\r\n    title: 'Price',\r\n    sortable: true,\r\n    sortType: 'number'\r\n  },\r\n  {\r\n    id: 'status',\r\n    title: 'Status',\r\n    sortable: true,\r\n    sortType: 'number',\r\n    template: data => {\r\n      return `<div class=\"sortable-table__cell\">\r\n          ${data > 0 ? 'Active' : 'Inactive'}\r\n        </div>`;\r\n    }\r\n  },\r\n];\r\n\r\nexport default header;\r\n","import RangePicker from '../../components/range-picker/index.js';\r\nimport SortableTable from '../../components/sortable-table/index.js';\r\nimport ColumnChart from '../../components/column-chart/index.js';\r\nimport header from './bestsellers-header.js';\r\n\r\nimport fetchJson from '../../utils/fetch-json.js';\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n\r\n  async getDataForColumnCharts (from, to) {\r\n    const ORDERS = `${process.env.BACKEND_URL}api/dashboard/orders?from=${from.toISOString()}&to=${to.toISOString()}`;\r\n    const SALES = `${process.env.BACKEND_URL}api/dashboard/sales?from=${from.toISOString()}&to=${to.toISOString()}`;\r\n    const CUSTOMERS = `${process.env.BACKEND_URL}api/dashboard/customers?from=${encodeURIComponent(from.toISOString())}&to=${encodeURIComponent(to.toISOString())}`;\r\n\r\n    const ordersData = fetchJson(ORDERS);\r\n    const salesData = fetchJson(SALES);\r\n    const customersData = fetchJson(CUSTOMERS);\r\n\r\n    const data = await Promise.all([ordersData, salesData, customersData]);\r\n    return data.map(item => Object.values(item));\r\n  }\r\n\r\n  async updateTableComponent (from, to) {\r\n    const data = await fetchJson(`${process.env.BACKEND_URL}api/dashboard/bestsellers?_start=1&_end=20&from=${from.toISOString()}&to=${to.toISOString()}`);\r\n    this.components.sortableTable.addRows(data);\r\n  }\r\n\r\n  async updateChartsComponents (from, to) {\r\n    const [ordersData, salesData, customersData] = await this.getDataForColumnCharts(from, to);\r\n    const ordersDataTotal = ordersData.reduce((accum, item) => accum + item);\r\n    const salesDataTotal = salesData.reduce((accum, item) => accum + item);\r\n    const customersDataTotal = customersData.reduce((accum, item) => accum + item);\r\n\r\n    this.components.ordersChart.update({headerData: ordersDataTotal, bodyData: ordersData});\r\n    this.components.salesChart.update({headerData: '$' + salesDataTotal, bodyData: salesData});\r\n    this.components.customersChart.update({headerData: customersDataTotal, bodyData: customersData});\r\n  }\r\n\r\n  async initComponents () {\r\n    const to = new Date();\r\n    const from = new Date(to.getTime() - (30 * 24 * 60 * 60 * 1000));\r\n    const [ordersData, salesData, customersData] = await this.getDataForColumnCharts(from, to);\r\n\r\n    const rangePicker = new RangePicker({\r\n      from,\r\n      to\r\n    });\r\n\r\n    const sortableTable = new SortableTable(header, {\r\n      url: `api/dashboard/bestsellers?_start=1&_end=20&from=${from.toISOString()}&to=${to.toISOString()}`,\r\n      isSortLocally: true\r\n    });\r\n\r\n    const ordersChart = new ColumnChart({\r\n      data: ordersData,\r\n      label: 'orders',\r\n      value: ordersData.reduce((accum, item) => accum + item),\r\n      link: '#'\r\n    });\r\n\r\n    const salesChart = new ColumnChart({\r\n      data: salesData,\r\n      label: 'sales',\r\n      value: '$' + salesData.reduce((accum, item) => accum + item),\r\n    });\r\n\r\n    const customersChart = new ColumnChart({\r\n      data: customersData,\r\n      label: 'customers',\r\n      value: customersData.reduce((accum, item) => accum + item),\r\n    });\r\n\r\n    this.components.sortableTable = sortableTable;\r\n    this.components.ordersChart = ordersChart;\r\n    this.components.salesChart = salesChart;\r\n    this.components.customersChart = customersChart;\r\n    this.components.rangePicker = rangePicker;\r\n  }\r\n\r\n  get template () {\r\n    return `<div class=\"dashboard\">\r\n      <div class=\"content__top-panel\">\r\n        <h2 class=\"page-title\">Dashboard</h2>\r\n        <!-- RangePicker component -->\r\n        <div data-element=\"rangePicker\"></div>\r\n      </div>\r\n      <div data-element=\"chartsRoot\" class=\"dashboard__charts\">\r\n        <!-- column-chart components -->\r\n        <div data-element=\"ordersChart\" class=\"dashboard__chart_orders\"></div>\r\n        <div data-element=\"salesChart\" class=\"dashboard__chart_sales\"></div>\r\n        <div data-element=\"customersChart\" class=\"dashboard__chart_customers\"></div>\r\n      </div>\r\n\r\n      <h3 class=\"block-title\">Best sellers</h3>\r\n\r\n      <div data-element=\"sortableTable\">\r\n        <!-- sortable-table component -->\r\n      </div>\r\n    </div>`;\r\n  }\r\n\r\n  async render () {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    await this.initComponents();\r\n\r\n    this.renderComponents();\r\n    this.initEventListeners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  renderComponents () {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      root.append(element);\r\n    });\r\n  }\r\n\r\n  getSubElements ($element) {\r\n    const elements = $element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  initEventListeners () {\r\n    this.components.rangePicker.element.addEventListener('date-select', event => {\r\n      const { from, to } = event.detail;\r\n      this.updateChartsComponents(from, to);\r\n      this.updateTableComponent(from, to);\r\n    });\r\n  }\r\n\r\n  destroy () {\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n  }\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n"],"sourceRoot":""}